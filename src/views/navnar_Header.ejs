<nav class="bg-white border-b border-gray-200 shadow-sm sticky top-0 w-full z-10">
    <div class="container mx-auto max-w-7xl px-4 flex justify-between items-center h-16">
        <!-- Logo -->
        <div class="left__nav flex items-center">
            <button id="openButton" onclick="openNav()" class="focus:outline-none">
                <i class="fas fa-bars text-gray-700 text-2xl"></i>
            </button>
            <a href="/" class="flex items-center pl-2">
                <!-- <img src="/images/logo/Aninight.png" alt="Logo" class="h-8 w-8"> -->
                <span class="text-lg font-semibold text-gray-700">ANINIGHT</span>
            </a>
        </div>

        <!-- Nav Links and Icons -->
        <div class="hidden md:flex items-center space-x-4">
            <a href="/" class="text-gray-700 hover:text-blue-500">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
            <a href="/trending" class="block text-gray-700 hover:text-blue-500">‡∏°‡∏≤‡πÅ‡∏£‡∏á</a>
            <a href="/forums" class="block text-gray-700 hover:text-blue-500">‡∏ü‡∏≠‡∏£‡∏±‡∏°</a>
            <a href="/live/aninight" class="block text-gray-700 hover:text-blue-500">LIVE</a>
            <!-- <a href="/news-pv" class="block text-gray-700 hover:text-blue-500">PV Anime</a> -->
            <!-- <a href="/anishots" class="block text-gray-700 hover:text-blue-500">Anishots</a> -->
             <div class="relative group">
                <a href="/notification/user" class="block relative text-gray-700 hover:text-blue-500">
                    <i class="fa-solid fa-calendar-days"></i>
                    <span class="bg-red-500 w-3 rounded-full h-3 top-0 left-2 absolute"></span>
                </a>
                <div
                    class="absolute hidden group-hover:block right-0">
                    <div
                        class="bg-white shadow-lg px-8 py-6 w-96 rounded-lg border-t-2 border-gray-200 overflow-y-auto h-[500px] md:h-[650px] no-scrollbar">
                        <div class="inline-flex items-center">
                            <i class="fa-solid fa-bell text-2xl"></i>
                            <span class="text-xl ml-2">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</span>
                        </div>
                        <hr class="mb-4 mt-2">
                        <div id="activities-container">
                            <!-- <div class="border border-gray-300 shadow rounded-md p-4 mt-4 max-w-sm w-full mx-auto">
                                <div class="flex space-x-4">
                                    <div class="flex-1 space-y-6 py-1">
                                        <h3>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</h3>
                                        <a href="#">
                                            <img src="https://via.placeholder.com/300x220" alt="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û" class="w-full" style="height: 200px;">
                                        </a>
                                    </div>
                                </div>
                            </div>                             -->
                        </div>
                    </div>
                </div>
             </div>
            <div class="relative group">
                <a href="/" class="block text-gray-700 hover:text-blue-500">
                    <i class="fa-solid fa-filter"></i>
                </a>
                <div class="absolute hidden group-hover:block bg-white right-0 shadow-lg mt-1 py-2 rounded-lg w-48 border border-gray-300 shadow-lg">
                    <a href="/browse/anime" class="block px-4 py-2 text-gray-800 hover:bg-gray-200">üñêüèª ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏∞</a>
                    <a href="/search" class="block px-4 py-2 text-gray-800 hover:bg-gray-200">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</a>
                    <a href="/categories" class="block px-4 py-2 text-gray-800 hover:bg-gray-200">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</a>
                    <a href="/articles" class="block px-4 py-2 text-gray-800 hover:bg-gray-200">‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</a>
                    <% if (!usersesstion) { %>
                        <a href="/login" class="block px-4 py-2 text-gray-800 hover:bg-gray-200">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
                        <% } %>
                            <% if (usersesstion) { %>
                                <a href="/upload_acticle"
                                    class="block px-4 py-2 text-gray-800 hover:bg-gray-200">‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô</a>
                                <% } %>
                </div>
            </div>
            <% if (!usersesstion) { %>
                <a href="/login" class="block px-4 py-2 text-gray-800 bg-red-500 text-white rounded-lg hover:bg-red-600">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
                <% } %>

                            <!-- Profile Dropdown -->
                            <div class="relative group">
                                <button class="focus:outline-none">
                                    <% if (usersesstion) { %>
                                        <a href="/profile?u=<%= usersesstion.username %>">
                                            <img class="w-9 h-9 rounded-full border-2 border-gray-300 cursor-pointer"
                                                src="/profiles/<%= usersesstion.profile %>" alt="User Avatar">
                                        </a>
                                        <% } %>
                                </button>
                                <% if (usersesstion) { %>
                                    <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏Å‡∏≤‡∏£‡πå‡∏î -->
                                    <div
                                        class="absolute right-1 transform hidden group-hover:block w-64 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-10">
                                        <div class="flex items-center">
                                            <img src="/profiles/<%= usersesstion.profile %>" alt="Profile Picture"
                                                class="w-12 h-12 rounded-full border-2 border-gray-300">
                                            <div class="ml-3">
                                                <h3 class="text-lg text-black font-semibold">
                                                    <%= usersesstion.name %>
                                                </h3>
                                                <p class="text-gray-500">@<%= usersesstion.username %>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="mt-4">
                                            <p class="text-sm text-gray-700">
                                                <%= usersesstion.bio %>.
                                            </p>
                                        </div>
                                        <div class="mt-4">
                                            <ul class="list-none">
                                                <li class="py-1"><a
                                                        href="/profile?u=<%= usersesstion.username %>"
                                                        class="block text-gray-700 rounded-lg p-2 hover:bg-gray-100">
                                                        <%= usersesstion.username %>
                                                    </a></li>
                                                <div class="relative">
                                                    <li class="py-1"><a href="#" class="block text-gray-700 rounded-lg p-2 hover:bg-gray-100">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</a>
                                                    </li>
                                                    <span class="absolute right-0 top-0 bg-red-500 text-white px-1 rounded-full">0</span>
                                                </div>
                                                <!-- <ul
                                                    class="absolute right-full top-40 mt-0 ml-2 hidden group-hover:block w-40 bg-white border border-gray-300 rounded-lg shadow-lg"> -->
                                                    <!-- header card -->
                                                    <!-- <div class="border-b-2 p-2">
                                                        <h3 class="text-lg font-bold text-black">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                                                    </div> -->
                                                    <!-- <li class="py-1 px-2"><a href="#" class="text-gray-700 hover:text-blue-500">Notification 1</a></li>
                                <li class="py-1 px-2"><a href="#" class="text-gray-700 hover:text-blue-500">Notification 2</a></li>
                                <li class="py-1 px-2"><a href="#" class="text-gray-700 hover:text-blue-500">Notification 3</a></li> -->
                                                <!-- </ul> -->
                                                <li class="py-1">
                                                    <form action="/logout/user" method="post">
                                                        <button type="submit" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full focus:outline-none" onclick="logout(event)">
                                                            ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                                                        </button>
                                                    </form>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="mt-4 border-t-2 p-2 flex items-center">
                                            <h2 class="text-black">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏´‡∏°‡∏î</h2>
                                            <div class=" mx-auto p-4">
                                                <div class="flex justify-end">
                                                    <label for="theme-toggle" class="inline-flex items-center cursor-pointer">
                                                        <div class="relative">
                                                            <input type="checkbox" id="theme-toggle" class="sr-only">
                                                            <div class="block-dack bg-gray-100 w-14 h-8 rounded-full">
                                                            </div>
                                                            <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition transform">
                                                            </div>
                                                        </div>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                        <% } %>
                            </div>
        </div>
</nav>

         

<style>
    .menu-hidden {
        display: none;
    }

    .menu-visible {
        display: block;
    }

    ::-webkit-scrollbar {
        width: 6px;
    }

    .activemenu {
        border-bottom: 3px solid #000;
        color: #000;
        font-weight: bold;
    }

    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }
</style>
<script>
    function closeNav() {
        document.getElementById("my__Sidebar").style.width = "0";
    }

    function openNav() {
        document.getElementById("my__Sidebar").style.width = "16rem";
    }

    document.getElementById("openButton").addEventListener("click", (event) => {
        event.stopPropagation();  // ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå
        openNav();
    });

    window.addEventListener("click", (event) => {
        const sidebar = document.getElementById("my__Sidebar");
        const openButton = document.getElementById("openButton");

        if (!sidebar.contains(event.target) && event.target !== openButton) {
            closeNav();
        }
    });
</script>


<% if (usersesstion) {%>
    <script>
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;
    
        const currentTheme = localStorage.getItem('theme') || 'light';
        if (currentTheme === 'dark') {
            body.classList.add('bg-black', 'text-white');
            body.classList.remove('bg-white', 'text-black');
            themeToggle.checked = true;
            document.querySelector('.dot').classList.add('translate-x-full', 'bg-white');
            document.querySelector('.block-dack').classList.add('bg-green-500');
        }
    
        themeToggle.addEventListener('change', () => {
            if (themeToggle.checked) {
                body.classList.add('bg-black', 'text-white');
                body.classList.remove('bg-white', 'text-black');
                localStorage.setItem('theme', 'dark');
                document.querySelector('.dot').classList.add('translate-x-full', 'bg-white');
                document.querySelector('.block-dack').classList.add('bg-green-500');
                document.querySelector('.block-dack').classList.remove('bg-gray-100');
            } else {
                body.classList.add('bg-gray.100', 'text-white');
                body.classList.remove('bg-black', 'text-white');
                localStorage.setItem('theme', 'light');
                document.querySelector('.dot').classList.remove('translate-x-full', 'bg-black');
                document.querySelector('.block-dack').classList.add('bg-gray-100');
                document.querySelector('.block-dack').classList.remove('bg-green-500');
            }
        });
    </script>
<% } %>

<script>
   document.addEventListener('DOMContentLoaded', function() {
    fetch('/api/activities')
        .then(response => response.json())
        .then(data => {
            const activitiesContainer = document.getElementById('activities-container');
            data.forEach(activity => {
                const activityElement = document.createElement('div');
                activityElement.classList.add('border', 'border-gray-300', 'shadow', 'rounded-md', 'p-4', 'mt-4', 'max-w-sm', 'w-full', 'mx-auto');

                activityElement.innerHTML = `
                    <div class="flex space-x-4">
                        <div class="flex-1 space-y-6 py-1">
                            <h3>${activity.title}</h3>
                            <p>${activity.description}</p>
                            <a href="${activity.link}" target="_blank">
                                <img src="/notification/${activity.imagePath}" alt="${activity.title}" class="w-full" style="height: 200px;">
                            </a>
                        </div>
                    </div>
                `;
                activitiesContainer.appendChild(activityElement);
            });
        })
        .catch(error => console.error('Error fetching activities:', error));
});

</script>